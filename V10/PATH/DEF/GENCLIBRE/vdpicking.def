NOMBRE=PICKING;

EXTRA=ERROR,V10LONG;

   
CURSOR=OPEPICKING SELECT CODOPE FROM VDUSUARIO WHERE CODOPE=:VDUSUARIO.CODOPE;    

SELECT=PRIVILEGIO,SELECT VDUSER.TIENEPRIVILEGIO(:VDUSUARIO.CODOPE,NVL(:VDPRIVOPE.PRIVILEGIO,'PICKING')) TIENEPRIVILEGIO FROM DUAL;                               
                     
SELECT=DATOSOPE,SELECT COUNT(DISTINCT OPA.CODOPE) NUMOPE, COUNT(DISTINCT BUZ.CODBULTO) NUMBULTOSZONA, COUNT (DISTINCT(DECODE(BUZ.CODOPE,:VDUSUARIO.CODOPE,BUZ.CODBULTO,0)))-1 NUMBULTOSOPE
                FROM VDBULTOZONA BUZ, VDOPEACTIVIDAD OPA
                WHERE OPA.CODZONA=:VDZONAS.CODZONA AND BUZ.CODZONA(+) = OPA.CODZONA AND
                      NVL(OPA.FECFINACT,0)=0 AND OPA.HORAFINACT IS NULL;
                
SELECT=DAMEPARAMMENU,SELECT VD.PIECE(IME.PARAM,'#',2) PARAM 
                     FROM VDZONAS ZON, VDINFOMENUS IME
                     WHERE ZON.CODZONA = :VDZONAS.CODZONA AND 
                           ZON.CODZONA = IME.CODZONA AND 
                           ZON.IDMENU = IME.IDMENU; 
                           
CURSOR=DATOSCANAL, SELECT 'U' UNICAPAC, DECODE(UNICAPAC,'C',COUNT(DISTINCT CANTIDAD), SUM(CANTIDAD)) CANTTOTAL
                   FROM (SELECT UBI.UNICAPAC, DECODE(UBI.UNICAPAC,'U',STK.CANTIDAD,'E',CEIL(STK.CANTIDAD/STK.UNIEMB),'C',STK.CODMAT) CANTIDAD
                         FROM VDSTOCK STK, VDCONTE CNT, VDUBICA UBI 
                         WHERE STK.CODMAT = CNT.CODMAT AND 
                               CNT.CODUBI = :VDUBICA.CODUBI AND
                               CNT.CODUBI = UBI.CODUBI 
                         ORDER BY STK.ORDENSTK)
                   GROUP BY UNICAPAC;                           
                           
CURSOR=DATOSBOCACANAL, SELECT STK.CODMAT, CNT.POSCONTE, STK.ORDENSTK, STK.CODART, STK.CODLOT, STK.UNIEMB, STK.EMBCONT, 
                              TRUNC(STK.CANTIDAD/STK.UNIEMB) BULTBOCACANAL, 
                              DECODE(MOD(STK.CANTIDAD,STK.UNIEMB),0,STK.UNIEMB,MOD(STK.CANTIDAD,STK.UNIEMB)) CANTBOCACANAL,
                              DECODE(UBI.UNICAPAC,'E','U','C','E','U') UNICAPAC 
                       FROM VDSTOCK STK, VDCONTE CNT, VDUBICA UBI 
                       WHERE STK.CODMAT = CNT.CODMAT AND 
                             CNT.CODUBI = :VDUBICA.CODUBI AND 
                             CNT.CODUBI = UBI.CODUBI      
                       ORDER BY CNT.POSCONTE, STK.ORDENSTK;     
                       
CURSOR=DATOSULTMOV, SELECT MOV.CODART, MOV.CODLOT, MOV.UNIEMB, MOV.EMBCONT, 0 CANTBOCACANAL, DECODE(UBI.UNICAPAC,'E','U','C','E','U') UNICAPAC 
                    FROM VDUBICA UBI, VDMOVIM MOV
                         WHERE UBI.CODUBI= :VDUBICA.CODUBI AND
                         VDCOM.DAMECOMEN(UBI.CODCOMEN,'CODMOVPICKUNI',1) = MOV.CODMOV;           
                         
CURSOR=DISPACTZONA SELECT IDI.IDINFOPICK, IDI.NUMDISP
                   FROM VDINFODISP IDI, VDINFOHARDDISP IHD
                   WHERE IDI.IDINFOPICK = IHD.IDINFOPICK AND
                         IDI.NUMDISP = IHD.NUMDISP AND
                         IDI.CODZONA = :VDZONAS.CODZONA AND
                         IDI.STATUS <> VDST.FIDIAPAGADO AND
                         IHD.TEXTO IS NOT NULL AND
                         NVL(IHD.LUCES,'0,0,0,0,0,0') <> '0,0,0,0,0,0';

CURSOR=HIJOSLUZ,SELECT IDINFOPICK, NUMDISP 
                FROM VDINFODISP
                WHERE IDINFOPICK = :VDINFODISP.IDINFOPICK AND NUMDISP = :VDINFODISP.NUMDISP AND
                      ((IDINFOPICK <> IDINFOPICKLUZ OR NUMLUZ <> NUMDISP) OR 
                       EXISTS (SELECT NUMDISP FROM VDINFODISP WHERE IDINFOPICKLUZ = :VDINFODISP.IDINFOPICK AND NUMLUZ = :VDINFODISP.NUMDISP AND
                               (IDINFOPICK <> IDINFOPICKLUZ OR NUMLUZ <> NUMDISP)));
                       

    