# MOdulo   : VDSTOCK.PAN
# Función  : Mantenimiento de stock
#
# Creación : 01-10-2007
# Autor    : EAA
###########################################
# HistOrico de cambios:
MANTENIMIENTO DE STOCK
Orden  Artículo   Designación                  Cantidad  Ultima modificación              Uni/emb E/con Bloqueos   Tipo     Precio        Peso         Extra           Coment.
@L9@@@ _20_______ _40_________________________ #L15##### _32________ ¿D-MM-Y.YY  ________ #L15### #L### __________ _10_____ #L12#####.### #L######.### _255___________ @L@@@@@@@
|
TABLA=VDSTOCK
ORDERBY=ORDENSTK;
PREINSERT=FEJECUTA("CSELMODIF","ERROR EN FECHA DE MODIFICACION")
PREUPDATE=FEJECUTA("CSELMODIF","ERROR EN FECHA DE MODIFICACION")

#NODELETE
NOUPDATE,PROTECT("ADMINISTRADOR")


CAMPO=CODMAT,VIRTUAL,OCULTO
CAMPO=ORDENSTK,TOOLTIP("Orden de la línea de stock en el contenedor"),TITULO("Orden")
CAMPO=CODART,NOUPDATE,TOOLTIP("Código del artículo"),POSTCHANGE=FDESIGNACION("CSELDESART","No existe artículo"),
#                         CONTEXTUAL=FEJECUTAFORM("VDSELART","N","","","CODART=:CODART","Selección de artículo","S"),
                         TITULO("Artículo")
CAMPO=DESART,NOUPDATE,AUXILIAR,NOENTER,TOOLTIP("Desgianción del articulo")
CAMPO=CANTIDAD,NOUPDATE("V10"),TOOLTIP("Cantidad en unidades host"),CONVIERTE=FCONVIERTEARTFROMDB(":CODART");FCONVIERTEART2DB(":CODART"),TITULO("Cantidad")
CAMPO=CODOPEMODIF,NOENTER,TOOLTIP("Operario que realizO la última modificación"),TITULO("Ultima modificación")
CAMPO=FECMODIF,NOENTER,TOOLTIP("Fecha en que se modificaron los datos del registro")
CAMPO=HORAMODIF,NOENTER,TOOLTIP("Hora en que se modificaron a los datos del registro")
CAMPO=CODLOT,NOUPDATE,TOOLTIP("Lote"),POSTCHANGE=FDESIGNACION("CSELCODLOT","No existe lote"),
#                        CONTEXTUAL=FEJECUTAFORM("VDLOTES","N","CODART=:CODART","","CODLOT=:CODLOT","Selección de lote","S"),
                         TITULO("Lote"),OCULTO,"_20"
CAMPO=CADUCI,NOUPDATE,AUXILIAR,NOENTER,WLONX=20,OCULTO,"________"
CAMPO=UNIEMB,TOOLTIP("Unidades por embalaje en unidades host"),CONVIERTE=FCONVIERTEARTFROMDB(":CODART");FCONVIERTEART2DB(":CODART"),TITULO("Uni/Emb"), WLONX=20
CAMPO=EMBCONT,PROTECT("STOCK"), TOOLTIP("Embalajes por contenedor"),TITULO("Emb/C"),WLONX=20
CAMPO=BLOQUEOS,TOOLTIP("Bloqueos del stock"),POSTCHANGE=FDESIGNACION("-CVERBLOQUEO",":ERROR"),TITULO("Bloqueos")
CAMPO=TIPOEMBA,NOUPDATE,TOOLTIP("Tipo de embalaje"),POSTCHANGE=FDESIGNACION("CSELTIPOEMBA","No existe tipo de embalaje"),TITULO("Tipo Emba"),WLONX=20
CAMPO=PRECIOUNI,NOUPDATE,TOOLTIP("Precio unitario del producto en unidades host"),CONVIERTE=FCONVIERTEINVARTFROMDB(":CODART");FCONVIERTEINVART2DB(":CODART"),TITULO("PrecioUni")
CAMPO=PESOUNI,NOUPDATE,TOOLTIP("Peso unitario del producto"),CONVIERTE=FCONVIERTEINVARTFROMDB(":CODART");FCONVIERTEINVART2DB(":CODART"),TITULO("PesoUni")
CAMPO=VDEXTRA,NOUPDATE,TOOLTIP("Información extra disponible para el implantador"),TITULO("Extra")
CAMPO=CODCOMEN,NOUPDATE,TOOLTIP("Código de comentario del contenedor"),TITULO("Comen")
CAMPO=ERROR,AUXILIAR,OCULTO,"_255"

CURSOR=CSELMODIF SELECT VDUSER.GETUSER CODOPEMODIF,VD.FECHASYS FECMODIF,VD.HORASYS HORAMODIF FROM DUAL;

CURSOR=CSELDESART BEGIN
                   SELECT DESART INTO :DESART
                      FROM VDARTIC WHERE CODART=:CODART;
                  END;@
CURSOR=CSELCODLOT SELECT :CODLOT,CADUCI FROM VDLOTES WHERE CODART=:CODART AND CODLOT=:CODLOT;

CURSOR=CSELTIPOEMBA SELECT :TIPOEMBA FROM VDTIPOEMBA WHERE TIPOEMBA=:TIPOEMBA;

CURSOR=CVERBLOQUEO SELECT VDART.VALIDABLOQUEO(:BLOQUEOS) ERROR FROM DUAL WHERE VDART.VALIDABLOQUEO(:BLOQUEOS) IS NOT NULL;


TECLA=SF9,FEJECUTAFORM("VDREGULARIZASTK","S","CODMAT=:CODMAT AND ORDENSTK=:ORDENSTK","","","REGULARIZACIONES DE STOCK","S")


