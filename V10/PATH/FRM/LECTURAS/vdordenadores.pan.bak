# Módulo   : VDORDENADORES.PAN
# Función  : Mantenimiento de tablas de ordenadores
#
# Creación : 11-07-2008
# Autor    : JMM
###########################################
# Histórico de cambios:
MANTENIMIENTO DE ORDENADORES
Ordenador                 Red  Escáner Puerto Velocidad Extra                Ultima modificacion                  
_32______________________ @L@   @L@     @@@    @@@@@    _255_______________  _32____________ ¿D-MM-Y.YYY _8______ 
|
TABLA=VDORDENADORES

ORDERBY=ORDENADOR;

PREINSERT=FEJECUTA("CSELNUMESCANER","ERROR OBTENIENDO NUMERO DE RED DE ESCANER",
                   "CINSIDINFOLECT","ERROR INSERTANDO EN TABLA IDINFOLECTURA",
                   "CSELMODIF","ERROR AL OBTENER LA FECHA DE MODIFICACION")
PREUPDATE=FEJECUTA("CUPDIDINFOLECT","ERROR ACTUALIZANDO IDINFOLECTURA",
                   "CSELMODIF","ERROR AL OBTENER LA FECHA DE MODIFICACION")

CAMPO=ORDENADOR,TOOLTIP("Nombre del ordenador"),TITULO("Ordenador")
CAMPO=IDINFOLECTURA,VIRTUAL,PROTECT("IMPLANTADOR"),TOOLTIP("Identificador de la red de escaneres"),POSTCHANGE=FDESIGNACION("+CSELIDINFOLECT",""),TITULO("Red"), WLONX=15
CAMPO=SCANNER,PROTECT("IMPLANTADOR"),TOOLTIP("Número de scaner de la red de escaners asociado al ordenador"),TITULO("Escaner"), WLONX=34
CAMPO=PUERTO232,AUXILIAR,TOOLTIP("Puerto al que está conectado el escaner"),TITULO("Puerto"), WLONX=30
CAMPO=VELOCIDAD,AUXILIAR,TOOLTIP("Velocidad en baudios del puerto 232"),TITULO("Velocidad"),WLONX=35
CAMPO=VDEXTRA,TOOLTIP("Datos adicionales externos a V10 y útiles para el cliente"),TITULO("Extra")
CAMPO=CODOPEMODIF,NOENTER,TOOLTIP("Codigo del operador o proceso que realizar la operacion de modificacion"),TITULO("Última Modificación")
CAMPO=FECMODIF,NOENTER,TOOLTIP("Fecha de la ultima modificacion")
CAMPO=HORAMODIF,NOENTER,TOOLTIP("Hora de la ultima modificacion")

CURSOR=CSELIDINFOLECT SELECT PUERTO232, VELOCIDAD FROM VDINFOLECTURAS WHERE IDINFOLECTURA = :IDINFOLECTURA;

CURSOR=CSELNUMESCANER SELECT NVL(MAX(IDINFOLECTURA),0)+1 IDINFOLECTURA,0 SCANNER
                        FROM VDINFOLECTURAS;

CURSOR=CINSIDINFOLECT INSERT INTO VDINFOLECTURAS (IDINFOLECTURA, DIRIP, PUERTOTCP, PUERTO232, VELOCIDAD, CHSTX, 
                                                  CHETX, CHSOH, LONIDSCAN, LONDATA, LIBPROCESO, VDEXTRA, CODOPEMODIF, FECMODIF, HORAMODIF) 
                      VALUES (:IDINFOLECTURA, NULL, NULL, :PUERTO232, :VELOCIDAD, 2, 
                              3, NULL, 0, NULL, 'VDINFOSCAN232.DLL', NULL, VDUSER.GETUSER, VD.FECHASYS,VD.HORASYS);

CURSOR=CUPDIDINFOLECT UPDATE VDINFOLECTURAS SET PUERTO232 = :PUERTO232, VELOCIDAD = :VELOCIDAD
                       WHERE IDINFOLECTURA = :IDINFOLECTURA;

CURSOR=CSELMODIF SELECT VDUSER.GETUSER CODOPEMODIF,VD.FECHASYS FECMODIF,VD.HORASYS HORAMODIF FROM DUAL;
