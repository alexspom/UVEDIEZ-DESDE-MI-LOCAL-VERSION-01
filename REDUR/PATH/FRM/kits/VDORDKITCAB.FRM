BEGINBLOQUE=VDORDKITCAB.PAN
  POSX=1
  POSY=1
  PREREGISTRO=PRESEHIJO
  
  TECLA=SF9,FEJECUTA("CCHECKDIV","SOLO SON EDITABLES LAS ORDENES DE BELLOTA",
                   "CHECKCANTIDAD","NO SE REDUCIR LA CANTIDAD DE LA ORDEN\n A UN NUMERO INFERIOR AL YA FABRICADO",
                   "INSNUEVAVERSION", "ERROR AL INSERTAR LA NUEVA VERSIÃ“N DEL KIT",
                   "INSNUVALINEA", "ERROR AL INSERTAR LA NUEVA LINEA DE KIT",
				   FCOMMIT,"",
				   FFAILURE,"NUEVA VERSION DE KIT CREADA", 
				   FPULSATECLAS("F3","F2"))
					
  CURSOR=INSNUEVAVERSION INSERT INTO VDORDKITCAB
	  (CODORDKIT, TIPOORDKIT, CODPROVE, CODDIV, CODOPEMODIF, FECMODIF, HORAMODIF, STATUS, FECCAPTURA, HORACAPTURA, CODART, CODLOT, CANTIDAD, NUMCAJAS, CODORDKITLIN, NUMIDOC, FECVALIDA, HORAVALIDA, FECFABKIT, UNIDADESHOSTCLI, SEQORDKIT)
	  SELECT CODORDKIT, TIPOORDKIT, CODPROVE, CODDIV, VDUSER.GETUSER, VD.FECHASYS, VD.HORASYS, 100, VD.FECHASYS, VD.HORASYS, CODART, CODLOT, :CANTIDAD, NUMCAJAS, CODORDKITLIN, NUMIDOC, FECVALIDA, HORAVALIDA, FECFABKIT, UNIDADESHOSTCLI, (SELECT MAX(SEQORDKIT) + 1 FROM VDORDKITCAB WHERE CODORDKIT = :CODORDKIT AND CODDIV = :CODDIV) 
	  FROM VDORDKITCAB WHERE CODORDKIT = :CODORDKIT AND CODDIV = :CODDIV AND SEQORDKIT = (SELECT MIN(SEQORDKIT) FROM VDORDKITCAB WHERE STATUS > 0 AND CODORDKIT = :CODORDKIT AND CODDIV = :CODDIV);

  CURSOR=INSNUVALINEA INSERT INTO VDORDKITLIN
	  (CODORDKIT, SECLINKIT, CODART, CODLOT, CANTIDAD, TODESTROY, NOTAS, CODOPEMODIF, FECMODIF, HORAMODIF, STATUS, BOXNUMBER, CODDIV, NUMIDOC, UNIDADESHOSTCLI, SEQORDKIT)
	  SELECT OKL.CODORDKIT, OKL.SECLINKIT, OKL.CODART, OKL.CODLOT, :CANTIDAD * ( OKL.CANTIDAD / OKC.CANTIDAD) , OKL.TODESTROY, OKL.NOTAS, VDUSER.GETUSER, VD.FECHASYS, VD.HORASYS, 100, OKL.BOXNUMBER, OKL.CODDIV, OKL.NUMIDOC, OKL.UNIDADESHOSTCLI, (SELECT MAX(SEQORDKIT) FROM VDORDKITCAB WHERE CODORDKIT = :CODORDKIT AND CODDIV = :CODDIV)
	  FROM VDORDKITLIN OKL, VDORDKITCAB OKC
	  WHERE OKC.CODORDKIT = OKL.CODORDKIT AND
		  OKC.SEQORDKIT = OKL.SEQORDKIT AND
		  OKC.SEQORDKIT = (SELECT MIN(SEQORDKIT) FROM VDORDKITCAB WHERE STATUS > 0 AND CODORDKIT = :CODORDKIT AND CODDIV = :CODDIV) AND
		  OKC.SEQORDKIT = OKL.SEQORDKIT
		 AND OKL.CODDIV = :CODDIV 
		 AND OKC.CODORDKIT = :CODORDKIT;
		 
  CURSOR=CHECKCANTIDAD SELECT :CANTIDAD FROM VDPEDIDOCAB WHERE STATUS >= 4000 AND PEDIDOHOST = :CODORDKIT HAVING COUNT(*) <= :CANTIDAD;
  
  CURSOR=CCHECKDIV SELECT :CODDIV FROM VDPEDIDOCAB WHERE PEDIDOHOST = :CODORDKIT AND CODDIV = 'BEL';

    BOTON=B1,1015,100,70,70,"P",crear.png,SF9,"Editar orden de kit",INCLUDECSS="background-color: transparent;border-width:0px"
  
ENDBLOQUE
BEGINBLOQUE=VDIMPETIQKIT.pan
  PADRE=VDORDKITCAB.PAN
  PREQUERY=QUERYHIJO
  POSX=1
  POSY=16
  WLONY=50
ENDBLOQUE  
BEGINBLOQUE=VDKITSLIN.PAN
  PADRE=VDORDKITCAB.PAN
  PREQUERY=QUERYHIJO
  REGPAG=15
  POSX=1
  POSY=22
  WLONY=380
ENDBLOQUE

BEGINBLOQUE=VDPEDPENDKITSTATUS.PAN
  PADRE=VDORDKITCAB.PAN
  PREREGISTRO=PRESEHIJO
  PREQUERY=QUERYHIJO
  POSX=1
  POSY=52
  WLONX=500
  REGPAG=9
  NOINSERT
  NODELETE
  NOUPDATE
  NOLOCK
ENDBLOQUE

BEGINBLOQUE=VDPEDPENDKITPED.PAN
  PADRE=VDPEDPENDKITSTATUS.PAN
  PREQUERY=QUERYHIJO
  POSX=80
  POSY=52
  WLONX=500
  REGPAG=9
  NOINSERT
  NODELETE
  NOUPDATE
  NOLOCK
ENDBLOQUE