
CURSOR=CPRIOMOV BEGIN
           FOR I IN (SELECT MOV.CODMOV,MOV.PRIOMOV,MIN(LEAST(SEP.PRIORIDAD,PEC.PRIORIDAD)) NUEVA
              FROM VDBULTOLIN BUL,VDBULTOCAB BUC,VDPEDIDOCAB PEC,VDSERIEPREP SEP,VDMOVIM MOV
              WHERE BUL.CODMOV=MOV.CODMOV AND BUL.CODBULTO=BUC.CODBULTO AND 
                    BUC.CODPED=PEC.CODPED AND BUC.CODDIV=PEC.CODDIV AND BUC.ANOPED=PEC.ANOPED AND BUC.SEQPED=PEC.SEQPED AND
                    PEC.CODSERIEPREP=SEP.CODSERIEPREP AND BUL.CODMOV=MOV.CODMOV   AND MOV.STATUS<4000  
              GROUP BY MOV.CODMOV,MOV.PRIOMOV
              HAVING MOV.PRIOMOV!=MIN(LEAST(SEP.PRIORIDAD,PEC.PRIORIDAD)) AND MOV.PRIOMOV<1000) LOOP
              UPDATE VDMOVIM SET PRIOMOV=I.NUEVA WHERE CODMOV=I.CODMOV;     
            END LOOP;
           FOR I IN (SELECT * FROM VDMOVIM WHERE STATUS=1300) LOOP
               UPDATE VDMOVIM SET PRIOMOV=LEAST(PRIOMOV,I.PRIOMOV) WHERE CODMOV=I.CODMOVESP AND PRIOMOV!=LEAST(PRIOMOV,I.PRIOMOV);
               IF SQL%ROWCOUNT>0 THEN
                  VDLOG.PONMENSAJE('PRIOMOV','ACTUALIZANDO PRIORIDAD A MOVIMIENTO',I.CODMOVESP,I.PRIOMOV);
                END IF;
            END LOOP;
           FOR I IN (SELECT CODART,MIN(PRIOMOV) PRIOMOV FROM VDMOVIM WHERE STATUS BETWEEN 1900 AND 1950 GROUP BY CODART) LOOP
               UPDATE VDMOVIM SET PRIOMOV=LEAST(PRIOMOV,I.PRIOMOV) WHERE CODART=I.CODART AND CODUBIDEST NOT LIKE 'EXP%' AND STATUS=2000 AND PRIOMOV>LEAST(PRIOMOV,I.PRIOMOV);
               IF SQL%ROWCOUNT>0 THEN
                  VDLOG.PONMENSAJE('PRIOMOV','ACTUALIZANDO PRIORIDAD A MOVIMIENTOS DEL ARTICULO',I.CODART,I.PRIOMOV,'ACTUALIZADOS',SQL%ROWCOUNT);
                END IF;
            END LOOP;
          END;@

CURSOR=CREUBICACONTE BEGIN
                       VDUBI.REUBICATRANSITO('0001');
                     END;@
                     
CURSOR=CREINTENTA UPDATE VDMOVIM SET STATUS=1900 WHERE STATUS=1950;                     
                     